<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>JSXMFacade.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jsxm-maven-plugin</a> &gt; <a href="index.html" class="el_package">org.jsxm.maven.plugin.jsxmtool</a> &gt; <span class="el_source">JSXMFacade.java</span></div><h1>JSXMFacade.java</h1><pre class="source lang-java linenums">/**
 * JSXM Maven PLugin CONFIDENTIAL
 * 
 *  __________________
 * 
 * Unpublished Copyright Â© 2012-2013 Konstantinos Margaritis, 
 * All Rights Reserved.
 * 
 * NOTICE:  All information contained herein is, and remains the property of Konstantinos Margaritis . 
 *
 * The intellectual and technical concepts contained herein are proprietary to the owner
 * Konstantinos Margaritis and may be covered by U.S and Foreign Patents, patents in process, 
 * and are protected by trade secret or copyright law. Dissemination of this information or 
 * reproduction of this material is strictly forbidden unless prior written permission is
 * obtained from Konstantinos Margaritis. Access to the source code contained herein is hereby 
 * forbidden to anyone except the owner.Confidentiality and Non-disclosure agreements 
 * explicitly covering such access.
 *
 * The copyright notice above does not evidence any actual or intended publication 
 * or disclosure  of  this source code, which includes information that is confidential 
 * and/or proprietary, and is a trade secret, of  Konstantinos Margaritis. ANY REPRODUCTION, 
 * MODIFICATION, DISTRIBUTION, PUBLIC  PERFORMANCE, OR PUBLIC DISPLAY OF OR THROUGH USE  OF 
 * THIS  SOURCE CODE  WITHOUT  THE EXPRESS WRITTEN CONSENT OF Konstantinos Margaritis IS STRICTLY PROHIBITED, 
 * AND IN VIOLATION OF APPLICABLE LAWS AND INTERNATIONAL TREATIES.  THE RECEIPT OR POSSESSION OF  
 * THIS SOURCE CODE AND/OR RELATED INFORMATION DOES NOT CONVEY OR IMPLY ANY RIGHTS  
 * TO REPRODUCE, DISCLOSE OR DISTRIBUTE ITS CONTENTS, OR TO MANUFACTURE, USE, OR SELL 
 * ANYTHING THAT IT  MAY DESCRIBE, IN WHOLE OR IN PART.  
 * 
 */
package org.jsxm.maven.plugin.jsxmtool;

import java.io.File;
import java.util.List;
import java.util.Properties;

import org.jsxm.maven.plugin.jsxmtool.animation.AnimatorType;
import org.jsxm.maven.plugin.jsxmtool.animation.SxmAnimationManager;
import org.jsxm.maven.plugin.jsxmtool.animation.batchanimation.SxmBanimationManager;
import org.jsxm.maven.plugin.jsxmtool.classpathaddition.ClassPathEntryEditor;
import org.jsxm.maven.plugin.jsxmtool.compilation.repast.RepastCompilationManager;
import org.jsxm.maven.plugin.jsxmtool.compilation.sxm.SxmCompilationManager;
import org.jsxm.maven.plugin.jsxmtool.compilation.sxm.controllers.SxmCompilationController;
import org.jsxm.maven.plugin.jsxmtool.core.JSXM;
import org.jsxm.maven.plugin.jsxmtool.core.JSXMThreadPoolFactory;
import org.jsxm.maven.plugin.jsxmtool.creation.examplescreation.SxmSampleCreationManager;
import org.jsxm.maven.plugin.jsxmtool.creation.javapackagecreation.PackageType;
import org.jsxm.maven.plugin.jsxmtool.creation.javapackagecreation.SxmPackageFactory;
import org.jsxm.maven.plugin.jsxmtool.generation.SxmGenerationManager;
import org.jsxm.maven.plugin.jsxmtool.generation.SxmTransformationManager;
import org.jsxm.maven.plugin.jsxmtool.logging.controllers.LogbackAppenderManager;
import org.jsxm.maven.plugin.jsxmtool.utilities.JSXMUtils;
import org.jsxm.maven.plugin.jsxmtool.validation.SxmValidationManager;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.slf4j.MDC;

/**
 * The Class JSXMFacade.
 *
 * @author Konstantinos Margaritis
 */
public final class JSXMFacade {
    
    /**
     * Instantiates a new jSXM facade.
     */
<span class="fc" id="L67">    private JSXMFacade() {</span>
<span class="fc" id="L68">    }</span>
    
    /**
     * The Class LazyHolder.
     */
<span class="nc" id="L73">    private static class LazyHolder {</span>
        
        /** The Constant INSTANCE. */
<span class="fc" id="L76">        private static final JSXMFacade INSTANCE = new JSXMFacade();</span>
    }
    
    /**
     * Gets the single instance of JSXMFacade.
     * 
     * @return single instance of JSXMFacade
     */
    public static JSXMFacade getInstance() {
<span class="fc" id="L85">        return LazyHolder.INSTANCE;</span>
    }
    
    /** The logger. */
<span class="fc" id="L89">    private final Logger logger = LoggerFactory.getLogger(this.getClass());</span>
    
    /**
     * Creates the specification provided by the user.
     * 
     * @param jsxmRootDir
     *            the jsxm root dir
     * @param jsxmList
     *            the jsxm list
     * @param testDirectory
     *            the test directory
     * @param javaDirectory
     *            the java directory
     */
    public void createSample(String jsxmRootDir, List&lt;String&gt; jsxmList, String testDirectory, String javaDirectory) {
<span class="fc" id="L104">        printState(&quot;Creates folders/subfolders, specifications/sets templates&quot;);</span>
<span class="fc" id="L105">        final SxmSampleCreationManager crFacade = new SxmSampleCreationManager();</span>
<span class="fc" id="L106">        crFacade.setJsxmList(jsxmList);</span>
<span class="fc" id="L107">        crFacade.setJsxmRootDir(jsxmRootDir);</span>
<span class="fc" id="L108">        crFacade.setJavaDirectory(javaDirectory);</span>
<span class="fc" id="L109">        crFacade.setTestDirectory(testDirectory);</span>
<span class="fc" id="L110">        crFacade.create();</span>
<span class="fc" id="L111">    }</span>
    
    /**
     * Validate.
     * 
     * @param jsxmSpecRootDir
     *            the jsxm spec root dir
     * @param testDirectory
     *            the test directory
     */
    public void validate(String jsxmSpecRootDir, String testDirectory) {
<span class="fc" id="L122">        printState(&quot;Validates the specification, sets and definitions&quot;);</span>
<span class="fc" id="L123">        SxmValidationManager.getInstance().validateJSXM(jsxmSpecRootDir, testDirectory);</span>
<span class="fc" id="L124">    }</span>
    
    /**
     * Compile specification.
     * 
     * @param m2Home
     *            the m2 home
     * @param tempTarget
     *            the temp target
     * @param testDirectory
     *            the test directory
     * @param javaDirectory
     *            the java directory
     * @param jsxmSpecRootDir
     *            the jsxm spec root dir
     * @param mode
     *            the mode
     * @param kInput
     *            the k input
     * @param sxmBaseImports
     *            the sxm base imports
     * @param sxmImports
     *            the sxm imports
     * @param sxmBaseInheritance
     *            the sxm base inheritance
     * @param kList
     *            the k list
     */
    public void compileSpecification(String m2Home, String tempTarget, String testDirectory, File javaDirectory,
            String jsxmSpecRootDir, String mode, String kInput, String sxmBaseImports, String sxmImports,
            String sxmBaseInheritance, Properties kList) {
<span class="fc" id="L155">        logger.debug(&quot;File Validation: &quot; + JSXM.getInstance().isValidate() + &quot;&quot;);</span>
<span class="pc bpc" id="L156" title="1 of 2 branches missed.">        if (JSXM.getInstance().isValidate()) {</span>
<span class="fc" id="L157">            printState(&quot;Generates the java files from the XML specification &quot;);</span>
<span class="fc" id="L158">            final SxmCompilationManager sxmC = new SxmCompilationManager();</span>
<span class="fc" id="L159">            sxmC.initialize(m2Home, tempTarget, testDirectory, javaDirectory, jsxmSpecRootDir, mode, kInput,</span>
                    sxmBaseImports, sxmImports, sxmBaseInheritance, kList);
        }
<span class="fc" id="L162">    }</span>
    
    /**
     * Scan specification java errors.
     *
     * @param tempTarget the temp target
     */
    public void compileSxmGeneratedFiles(String tempTarget) {
<span class="fc" id="L170">        final SxmCompilationController sxmCompErrController = new SxmCompilationController();</span>
<span class="fc" id="L171">        sxmCompErrController.compileSxmJavaFiles(tempTarget);</span>
<span class="fc" id="L172">    }</span>
    
    /**
     * Compile repast specfication.
     * 
     * @param m2HomeRepast
     *            the m2 home repast
     * @param tempTargetRepast
     *            the temp target repast
     * @param testDirectoryRepast
     *            the test directory repast
     * @param javaDirectoryRepast
     *            the java directory repast
     * @param jsxmSpecRootDirRepast
     *            the jsxm spec root dir repast
     * @param modeRepast
     *            the mode repast
     * @param kInputRepast
     *            the k input repast
     * @param repastSxmBaseImports
     *            the repast sxm base imports
     * @param repastSxmImports
     *            the repast sxm imports
     * @param repastSxmBaseInheritance
     *            the repast sxm base inheritance
     * @param kList
     *            the k list
     * @param repastCopyDirectory
     *            the repast copy directory
     */
    public void compileRepastSpecfication(String m2HomeRepast, String tempTargetRepast, String testDirectoryRepast,
            File javaDirectoryRepast, String jsxmSpecRootDirRepast, String modeRepast, String kInputRepast,
            String repastSxmBaseImports, String repastSxmImports, String repastSxmBaseInheritance, Properties kList,
            String repastCopyDirectory) {
<span class="fc" id="L206">        JSXM.getInstance().setCompileRepast(true);</span>
<span class="fc" id="L207">        printState(&quot;Generates the Repast java files from the XML specification&quot;);</span>
<span class="fc" id="L208">        final RepastCompilationManager repastCompilationManager = new RepastCompilationManager();</span>
<span class="fc" id="L209">        repastCompilationManager.compileRepast(m2HomeRepast, tempTargetRepast, testDirectoryRepast,</span>
                javaDirectoryRepast, jsxmSpecRootDirRepast, modeRepast, kInputRepast, repastSxmBaseImports,
                repastSxmImports, repastSxmBaseInheritance, kList);
<span class="fc" id="L212">        printState(&quot;Copying SXM &amp; SXMBase files&quot;);</span>
<span class="fc" id="L213">        repastCompilationManager.copyRepast(repastCopyDirectory);</span>
        
<span class="fc" id="L215">    }</span>
    
    /**
     * Generate tests.
     */
    public void generateTests() {
<span class="pc bpc" id="L221" title="1 of 2 branches missed.">        if (JSXM.getInstance().isValidate()) {</span>
<span class="fc" id="L222">            printState(&quot;Generates the XML file for tests&quot;);</span>
<span class="fc" id="L223">            final SxmGenerationManager sxmG = new SxmGenerationManager();</span>
<span class="fc" id="L224">            sxmG.generate();</span>
        }
<span class="fc" id="L226">    }</span>
    
    /**
     * Transform tests.
     */
    public void transformTests() {
<span class="pc bpc" id="L232" title="1 of 2 branches missed.">        if (JSXM.getInstance().isValidate()) {</span>
<span class="fc" id="L233">            printState(&quot;Generates the JUNIT files&quot;);</span>
<span class="fc" id="L234">            final SxmTransformationManager sxmTransformationManager = new SxmTransformationManager();</span>
<span class="fc" id="L235">            sxmTransformationManager.transform();</span>
        }
<span class="fc" id="L237">    }</span>
    
    /**
     * Banimate.
     * 
     * @param banimateAll
     *            the banimate all
     * @param banimateList
     *            the banimate list
     * @param silent
     *            the silent
     */
    public void banimate(boolean banimateAll, List&lt;String&gt; banimateList, boolean silent) {
<span class="fc" id="L250">        MDC.put(&quot;specificationName&quot;, &quot;general-Log&quot;);</span>
<span class="fc" id="L251">        printState(&quot;Animates the specification Using an input file&quot;);</span>
<span class="fc" id="L252">        MDC.remove(&quot;specificationName&quot;);</span>
<span class="fc" id="L253">        final SxmBanimationManager sxmBan = new SxmBanimationManager(banimateAll, banimateList, silent);</span>
<span class="fc" id="L254">        sxmBan.banimate();</span>
<span class="fc" id="L255">    }</span>
    
    /**
     * Animate console.
     *
     * @param animateList the animate list
     * @param animateAll the animate all
     * @param txtInput the txt input
     */
    public void animateConsole(List&lt;String&gt; animateList, boolean animateAll,boolean txtInput) {
<span class="fc" id="L265">        printState(&quot;Interactive Animation&quot;);</span>
<span class="fc" id="L266">        final SxmAnimationManager sxmAnimManager = new SxmAnimationManager(animateList, animateAll,txtInput);</span>
<span class="fc" id="L267">        sxmAnimManager.animate(AnimatorType.CONSOLE);</span>
<span class="fc" id="L268">    }</span>
    
    /**
     * Animate gui.
     *
     * @param animateList the animate list
     * @param animateAll the animate all
     * @param delay the delay
     */
    public void animateGUI(List&lt;String&gt; animateList, boolean animateAll,int delay) {
<span class="nc" id="L278">        printState(&quot;GUI Animation&quot;);</span>
<span class="nc" id="L279">        final SxmAnimationManager sxmAnimManager = new SxmAnimationManager(animateList, animateAll,delay);</span>
<span class="nc" id="L280">        sxmAnimManager.animate(AnimatorType.GUI);</span>
<span class="nc" id="L281">    }</span>
    
    /**
     * Adds the specification to class path.
     *
     * @param baseDir the base dir
     * @param jsxmSpecRootDir the jsxm spec root dir
     * @param topView the top view
     */
    public void addSpecificationToClassPath(String baseDir, String jsxmSpecRootDir,boolean topView) {
<span class="fc" id="L291">        final ClassPathEntryEditor addSF = new ClassPathEntryEditor();</span>
<span class="fc" id="L292">        final String exlusion = &quot;animation/|specification/|testAdapters/|tests/|xjcgen/&quot;;</span>
<span class="fc" id="L293">        addSF.updateClassPath(baseDir, jsxmSpecRootDir, exlusion,topView);</span>
<span class="fc" id="L294">    }</span>
    
    /**
     * Copy java package structure.
     * 
     * @param javaDirectory
     *            the java directory
     * @param baseDir
     *            the base dir
     */
    public void copyJavaPackageStructure(File javaDirectory, String baseDir) {
<span class="fc" id="L305">        printState(&quot;Copying java package structure/Creating specification folders.&quot;);</span>
<span class="fc" id="L306">        final SxmPackageFactory internalPackageCreator = new SxmPackageFactory();</span>
<span class="fc" id="L307">        internalPackageCreator.getCreator(PackageType.INTERNAL, javaDirectory, null).createSpecificationsFromPackages(baseDir);</span>
        /*
         * See revision 548 for non factory constructor.
         */
<span class="fc" id="L311">    }</span>
    
    /**
     * Copy external java pacskage structure.
     *
     * @param baseDir the base dir
     * @param externalPackageList the external package list
     */
    public void copyExternalJavaPackageStructure(String baseDir, List&lt;String&gt; externalPackageList) {
<span class="fc" id="L320">        printState(&quot;Copying java package external structure/Creating specification folders.&quot;);</span>
<span class="fc" id="L321">        final SxmPackageFactory externalPackageCreator = new SxmPackageFactory();</span>
<span class="fc" id="L322">        externalPackageCreator.getCreator(PackageType.EXTERNAL, null, externalPackageList).createSpecificationsFromPackages(</span>
                baseDir);
        /*
         * See revision 548 for non factory constructor.
         */
<span class="fc" id="L327">    }</span>
        
    /**
     * Sets the LOGGER levels of the 3 different
     * appenders that jsxm-maven-plugin is using
     * and enables ANSI support if selected by the user.
     *
     * @param consoleLoggerLevel the console logger level
     * @param htmlFileLoggerLevel the html file logger level
     * @param txtFileLoggerLevel the txt file logger level
     * @param ansiSupport the ansi support
     */
    public void initiateLogging(String consoleLoggerLevel,String htmlFileLoggerLevel,String txtFileLoggerLevel,boolean ansiSupport) {
<span class="fc" id="L340">        final LogbackAppenderManager logbackManager=new LogbackAppenderManager();</span>
<span class="fc" id="L341">        logbackManager.setConsoleLoggerLevel(consoleLoggerLevel);</span>
<span class="fc" id="L342">        logbackManager.setHtmlFileLoggerLevel(htmlFileLoggerLevel);</span>
<span class="fc" id="L343">        logbackManager.setTxtFileLoggerLevel(txtFileLoggerLevel);</span>
<span class="fc" id="L344">        logbackManager.setAnsiSupport(ansiSupport);</span>
<span class="fc" id="L345">        logbackManager.setGlobalLoggers();</span>
<span class="fc" id="L346">    }</span>
    
    /**
     * Sets the pdf report requirements.
     *
     * @param pdfReportFlag the pdf report flag
     * @param projectName the project name
     */
    public void setPDFReportRequirements(boolean pdfReportFlag, String projectName){
<span class="fc" id="L355">        JSXM.getInstance().setPdfReport(pdfReportFlag);</span>
<span class="fc" id="L356">        JSXM.getInstance().setProjectName(projectName);</span>
<span class="fc" id="L357">    }</span>
    
    /**
     * Creates the pdf report.
     *
     * @param pdfReportFlag the pdf report flag
     * @param projectName the project name
     */
    public void createPDFReport(boolean pdfReportFlag, String projectName){
<span class="fc" id="L366">        setPDFReportRequirements( pdfReportFlag,  projectName);</span>
<span class="fc" id="L367">        JSXMUtils.pdfReport(JSXM.getInstance().isPdfReport(), &quot;.txt&quot;);</span>
<span class="fc" id="L368">    }</span>
    
    /**
     * Prints the state.
     * 
     * @param state
     *            the state
     */
    public void printState(String state) {
<span class="fc" id="L377">        synchronized (this) {</span>
<span class="fc" id="L378">            logger.info(&quot;&lt;!-- ########################################################################## --&gt;&quot;);</span>
<span class="fc" id="L379">            logger.info(&quot;&lt;!-- &quot; + state + &quot;--&gt;&quot;);</span>
<span class="fc" id="L380">            logger.info(&quot;&lt;!-- ########################################################################## --&gt;\n&quot;);</span>
<span class="pc" id="L381">        }</span>
<span class="fc" id="L382">    }</span>
        
    /**
     * Sets the multi threaded.
     *
     * @param banimationThreadPool the banimation thread pool
     * @param compilationThreadPool the compilation thread pool
     * @param sampleCreationThreadPool the sample creation thread pool
     * @param externalPackageCreationThreadPool the external package creation thread pool
     * @param generationThreadPool the generation thread pool
     * @param transformationThreadPool the transformation thread pool
     * @param validationThreadPool the validation thread pool
     */
    public void setMultiThreaded(String banimationThreadPool, String compilationThreadPool,
            String sampleCreationThreadPool, String externalPackageCreationThreadPool, String generationThreadPool,
            String transformationThreadPool, String validationThreadPool) {
        
<span class="fc" id="L399">        JSXMThreadPoolFactory.getInstance().setBanimationThreadPool(banimationThreadPool);</span>
<span class="fc" id="L400">        JSXMThreadPoolFactory.getInstance().setCompilationThreadPool(compilationThreadPool);</span>
<span class="fc" id="L401">        JSXMThreadPoolFactory.getInstance().setSampleCreationThreadPool(sampleCreationThreadPool);</span>
<span class="fc" id="L402">        JSXMThreadPoolFactory.getInstance().setExternalPackageCreationThreadPool(externalPackageCreationThreadPool);</span>
<span class="fc" id="L403">        JSXMThreadPoolFactory.getInstance().setGenerationThreadPool(generationThreadPool);</span>
<span class="fc" id="L404">        JSXMThreadPoolFactory.getInstance().setTransformationThreadPool(transformationThreadPool);</span>
<span class="fc" id="L405">        JSXMThreadPoolFactory.getInstance().setValidationThreadPool(validationThreadPool);</span>
<span class="fc" id="L406">    }</span>
    
    /**
     * Override threads.
     *
     * @param threads the threads
     */
    public void overrideThreads(int threads){
<span class="nc" id="L414">        JSXMThreadPoolFactory.getInstance().setUserThreads(threads);</span>
<span class="nc" id="L415">    }</span>

    /**
     * Creates the prototype.
     *
     * @param jsxmRootDir the jsxm root dir
     * @param jsxmList the jsxm list
     */
    public void createPrototype(String jsxmRootDir, List&lt;String&gt; jsxmList) {
        
        
<span class="nc" id="L426">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.3.201306030806</span></div></body></html>